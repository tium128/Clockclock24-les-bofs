<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClockClock24 - Choreography Designer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ClockClock24 Choreography Designer</h1>
            <div class="project-controls">
                <input type="text" id="projectName" placeholder="Nom du projet" value="nouvelle_choregraphie">
                <button onclick="exportProject()">üì§ Exporter JSON</button>
                <button onclick="importProject()">üì• Importer JSON</button>
                <input type="file" id="importFile" accept=".json" style="display:none" onchange="handleFileImport(event)">
            </div>
        </header>

        <div class="main-content">
            <!-- Keyframes Timeline -->
            <div class="timeline-section">
                <h2>Keyframes</h2>
                <div class="timeline-controls">
                    <button onclick="addKeyframe()">+ Ajouter</button>
                    <button onclick="duplicateKeyframe()">üìã Dupliquer</button>
                    <button onclick="deleteKeyframe()">üóëÔ∏è Supprimer</button>
                    <span class="controls-separator">|</span>
                    <button onclick="moveKeyframeUp()" title="D√©placer vers le d√©but">‚óÄ Avant</button>
                    <button onclick="moveKeyframeDown()" title="D√©placer vers la fin">Apr√®s ‚ñ∂</button>
                    <span class="controls-separator">|</span>
                    <button onclick="setLoopStart()" title="D√©finir d√©but de boucle" class="loop-btn">[ D√©but</button>
                    <button onclick="setLoopEnd()" title="D√©finir fin de boucle" class="loop-btn">Fin ]</button>
                    <label class="loop-count-label" title="Nombre de r√©p√©titions (0 = infini)">
                        <input type="number" id="loopCountInput" value="3" min="0" max="99" onchange="updateLoopCount(this.value)">x
                    </label>
                    <button onclick="clearLoop()" title="Supprimer la boucle" class="loop-btn-clear">Suppr. boucle</button>
                    <span id="loopInfo" class="loop-info" style="display:none;"></span>
                </div>
                <p class="timeline-hint">üí° Glissez-d√©posez les keyframes pour les r√©ordonner | Utilisez [ et ] pour d√©finir une boucle</p>
                <div class="timeline" id="timeline"></div>
            </div>

            <!-- Clock Matrix -->
            <div class="matrix-section">
                <h2>Keyframe <span id="currentKeyframeNum">1</span></h2>

                <!-- Motion Parameters -->
                <div class="motion-params">
                    <div class="param-group">
                        <label for="kfSpeed">Vitesse</label>
                        <input type="number" id="kfSpeed" value="400" min="200" max="5000" step="50" onchange="saveSpeed()">
                        <span class="param-unit">pas/s</span>
                    </div>
                    <div class="param-group">
                        <label for="kfAccel">Acc√©l√©ration</label>
                        <input type="number" id="kfAccel" value="150" min="100" max="2000" step="50" onchange="saveAccel()">
                        <span class="param-unit">pas/s¬≤</span>
                    </div>
                    <div class="param-group">
                        <label for="kfDelay">D√©lai apr√®s</label>
                        <input type="number" id="kfDelay" value="0" min="0" max="10000" step="100" onchange="saveDelay()">
                        <span class="param-unit">ms</span>
                    </div>
                    <div class="param-separator"></div>
                    <div class="param-group">
                        <label for="kfCascadeMode">Cascade</label>
                        <select id="kfCascadeMode" onchange="saveCascadeMode()">
                            <option value="none">Aucune</option>
                            <option value="column">Colonne</option>
                            <option value="row">Ligne</option>
                            <option value="diagonal">Diagonale</option>
                            <option value="ripple">Ondulation (centre vers ext.)</option>
                            <option value="ripple_in">Ondulation (ext. vers centre)</option>
                            <option value="snake">Serpent</option>
                            <option value="spiral">Spirale</option>
                        </select>
                    </div>
                    <div class="param-group" id="cascadeDelayGroup" style="display: none;">
                        <label for="kfCascadeDelay">D√©lai cascade</label>
                        <input type="number" id="kfCascadeDelay" value="100" min="0" max="2000" step="50" onchange="saveCascadeDelay()">
                        <span class="param-unit">ms</span>
                    </div>
                </div>

                <div class="matrix-header">
                    <div class="slave-labels">
                        <span></span>
                        <span>Slave 1</span>
                        <span>Slave 2</span>
                        <span>Slave 3</span>
                        <span>Slave 4</span>
                        <span>Slave 5</span>
                        <span>Slave 6</span>
                        <span>Slave 7</span>
                        <span>Slave 8</span>
                    </div>
                </div>
                <div class="clock-matrix" id="clockMatrix"></div>

                <!-- Comment section -->
                <div class="comment-section">
                    <label for="keyframeComment">Commentaire / Instructions:</label>
                    <textarea id="keyframeComment" placeholder="Ex: d√©clenche les mouvements colonne par colonne avec un d√©calage de 500ms" onchange="saveComment()"></textarea>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h3>Actions rapides</h3>
                <div class="action-group">
                    <h4>Preset angles</h4>
                    <button onclick="setAllAngles(0, 0)">12:00 (0¬∞/0¬∞)</button>
                    <button onclick="setAllAngles(90, 90)">3:00 (90¬∞/90¬∞)</button>
                    <button onclick="setAllAngles(180, 180)">6:00 (180¬∞/180¬∞)</button>
                    <button onclick="setAllAngles(270, 270)">9:00 (270¬∞/270¬∞)</button>
                    <button onclick="setAllAngles(135, 315)">Diagonal ‚Üó</button>
                    <button onclick="setAllAngles(225, 45)">Diagonal ‚Üô</button>
                </div>
                <div class="action-group">
                    <h4>Directions</h4>
                    <button onclick="setAllDirections('CW', 'CW')">Tout CW</button>
                    <button onclick="setAllDirections('CCW', 'CCW')">Tout CCW</button>
                    <button onclick="setAllDirections('CW', 'CCW')">H:CW M:CCW</button>
                    <button onclick="setAllDirections('CCW', 'CW')">H:CCW M:CW</button>
                </div>
                <div class="action-group">
                    <h4>S√©lection</h4>
                    <button onclick="selectAll()">Tout s√©lectionner</button>
                    <button onclick="selectNone()">D√©s√©lectionner</button>
                    <button onclick="selectColumn()">S√©lectionner colonne</button>
                    <button onclick="selectRow()">S√©lectionner ligne</button>
                </div>
            </div>
        </div>

        <!-- Preview Panel -->
        <div class="preview-section">
            <h2>Aper√ßu</h2>
            <div class="preview-controls">
                <button onclick="previewPrevious()">‚èÆÔ∏è</button>
                <button onclick="playPreview()" id="playBtn">‚ñ∂Ô∏è Play</button>
                <button onclick="previewNext()">‚è≠Ô∏è</button>
                <label>
                    Dur√©e transition:
                    <input type="number" id="transitionDuration" value="1000" min="100" max="5000" step="100">ms
                </label>
            </div>
            <canvas id="previewCanvas" width="640" height="240"></canvas>
        </div>

        <!-- Code Output -->
        <div class="code-section">
            <h2>Code C++ g√©n√©r√©</h2>
            <button onclick="generateCode()">G√©n√©rer le code</button>
            <button onclick="copyCode()">üìã Copier</button>
            <pre id="codeOutput"></pre>
        </div>
    </div>

    <!-- Keyboard shortcuts help -->
    <div class="shortcuts-help">
        <h4>Raccourcis clavier</h4>
        <p><kbd>Ctrl</kbd>+<kbd>C</kbd> Copier</p>
        <p><kbd>Ctrl</kbd>+<kbd>V</kbd> Coller</p>
        <p><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>V</kbd> Sym√©trie verticale</p>
        <p><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>H</kbd> Sym√©trie horizontale</p>
        <p><kbd>Ctrl</kbd>+<kbd>A</kbd> Tout s√©lectionner</p>
        <p><kbd>Escape</kbd> D√©s√©lectionner</p>
        <p><kbd>Delete</kbd> R√©initialiser</p>
        <p><kbd>‚Üê</kbd> <kbd>‚Üí</kbd> Keyframes</p>
        <p><kbd>Shift</kbd>+clic Multi-s√©lection</p>
    </div>

    <script src="app.js"></script>
</body>
</html>
